<!-- Плавное затемнение фона до чёрного -->
<div class="bg-fade" aria-hidden="true"></div>

<div class="page">
  <!-- Скролл-зона, внутри неё происходит замена секций -->
  <div class="scroll-stage" #scrollStage>
    <div class="sticky">
      <div class="panels">
        <!-- PANEL: Coaches (исчезает при скролле) -->
        <section class="panel coach-panel" [class.panel-disabled]="scrollP() > 0.60">
          <div class="section-head">
            <div class="section-title">Coaches</div>
            <button mat-raised-button color="primary" (click)="refresh()">
              <mat-icon>refresh</mat-icon>
              Refresh
            </button>
          </div>

          <div class="coach-grid" *ngIf="coaches().length">
            <button
              class="coach-btn"
              type="button"
              *ngFor="let c of coaches(); trackBy: trackByCoach"
              (click)="open(c)"
              aria-label="Open coach details"
            >
              <mat-card class="coach-card" appearance="outlined">
                <div class="photo-wrap coach-photo">
                  <img class="photo" [src]="c.photoUrl" [alt]="c.fullName" />
                  <div class="photo-topline"></div>

                  <!-- Видимо всегда: только имя/фамилия -->
                  <div class="name-badge">
                    <div class="name">{{ c.fullName }}</div>
                  </div>
                </div>

                <!-- Остальное: только при наведении -->
                <div class="details">
                  <div class="details-topline"></div>

                  <div class="details-body">
                    <div class="details-name">{{ c.fullName }}</div>
                    <div class="details-role">{{ c.role }}</div>

                    <div class="details-text">{{ c.shortBio }}</div>

                    <div class="chips">
                      <mat-chip-set>
                        <mat-chip *ngFor="let s of c.skills.slice(0, 6)">{{ s }}</mat-chip>
                      </mat-chip-set>
                    </div>

                    <div class="cta">
                      <span>Открыть профиль</span>
                      <span class="dot"></span>
                    </div>
                  </div>
                </div>
              </mat-card>
            </button>
          </div>
        </section>

        <!-- PANEL: Team Members (появляется при скролле) -->
        <section class="panel members-panel" [class.panel-disabled]="scrollP() < 0.40">
          <mat-divider class="red-divider"></mat-divider>

          <div class="section-head second">
            <div class="section-title">Team Members</div>
          </div>

          <div *ngIf="members().length; else empty" class="marquee">
            <div class="marquee-viewport" aria-label="Team members carousel">
              <div class="marquee-track">
                <button
                  class="card-btn"
                  type="button"
                  *ngFor="let m of membersLoop(); trackBy: trackByMember"
                  (click)="open(m)"
                  aria-label="Open team member details"
                >
                  <mat-card class="member-card" appearance="outlined">
                    <div class="photo-wrap">
                      <img class="photo" [src]="m.photoUrl" [alt]="m.fullName" />
                      <div class="photo-topline"></div>

                      <div class="name-badge">
                        <div class="name">{{ m.fullName }}</div>
                      </div>
                    </div>

                    <div class="details">
                      <div class="details-topline"></div>

                      <div class="details-body">
                        <div class="details-name">{{ m.fullName }}</div>
                        <div class="details-role">{{ m.role }}</div>

                        <div class="details-text">{{ m.shortBio }}</div>

                        <div class="chips">
                          <mat-chip-set>
                            <mat-chip *ngFor="let s of m.skills.slice(0, 6)">{{ s }}</mat-chip>
                          </mat-chip-set>
                        </div>

                        <div class="cta">
                          <span>Подробнее</span>
                          <span class="dot"></span>
                        </div>
                      </div>
                    </div>
                  </mat-card>
                </button>
              </div>
            </div>
          </div>

          <ng-template #empty>
            <div class="empty">
              <mat-icon>group_off</mat-icon>
              <div>
                <div class="empty-title">Нет данных</div>
                <div class="empty-hint">Проверь мок-данные или нажми Refresh.</div>
              </div>
            </div>
          </ng-template>
        </section>
      </div>
    </div>
  </div>
</div>
